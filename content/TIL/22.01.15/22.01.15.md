---
emoji: β—
title: 22.01.15 TIL
date: '2022-01-15 00:00:00'
author: 95Donguk
tags: TIL
categories: TIL
---

# [λ¨λ“  κ°λ°μλ¥Ό μ„ν• HTTP μ›Ή κΈ°λ³Έμ§€μ‹](https://www.inflearn.com/course/http-%EC%9B%B9-%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC) μκ°•
***
> ## HTTP ν—¤λ”2 - μΊμ‹μ™€ μ΅°κ±΄λ¶€ μ”μ²­ - μΊμ‹ κΈ°λ³Έ λ™μ‘

![HTTP_header_cache_1.PNG](./HTTP_header_cache_1.PNG)
![HTTP_header_cache_2.PNG](./HTTP_header_cache_2.PNG)
![HTTP_header_cache_3.PNG](./HTTP_header_cache_3.PNG)
![HTTP_header_cache_4.PNG](./HTTP_header_cache_4.PNG)

### μΊμ‹κ°€ μ—†μ„ λ•
* λ°μ΄ν„°κ°€ λ³€κ²½λμ§€ μ•μ•„λ„ κ³„μ† λ„¤νΈμ›ν¬λ¥Ό ν†µν•΄μ„ λ°μ΄ν„°λ¥Ό λ‹¤μ΄λ΅λ“λ°›μ•„μ•Ό ν•λ‹¤.
* μΈν„°λ„· λ„¤νΈμ›ν¬λ” λ§¤μ° λλ¦¬κ³  λΉ„μ‹Έλ‹¤.
* λΈλΌμ°μ € λ΅λ”© μ†λ„κ°€ λλ¦¬λ‹¤.
* λλ¦° μ‚¬μ©μ κ²½ν—

![HTTP_header_cache_5.PNG](./HTTP_header_cache_5.PNG)
![HTTP_header_cache_6.PNG](./HTTP_header_cache_6.PNG)
![HTTP_header_cache_7.PNG](./HTTP_header_cache_7.PNG)
![HTTP_header_cache_8.PNG](./HTTP_header_cache_8.PNG)

### μΊμ‹ μ μ©
* μΊμ‹ λ•λ¶„μ— μΊμ‹ κ°€λ¥ μ‹κ°„ λ™μ• λ„¤νΈμ›ν¬λ¥Ό μ‚¬μ©ν•μ§€ μ•μ•„λ„ λλ‹¤.
* λΉ„μ‹Ό λ„¤νΈμ›ν¬ μ‚¬μ©λ‰μ„ μ¤„μΌ μ μλ‹¤.
* λΈλΌμ°μ € λ΅λ”© μ†λ„κ°€ λ§¤μ° λΉ λ¥΄λ‹¤.
* λΉ λ¥Έ μ‚¬μ©μ κ²½ν—

![HTTP_header_cache_9.PNG](./HTTP_header_cache_9.PNG)
![HTTP_header_cache_10.PNG](./HTTP_header_cache_10.PNG)
![HTTP_header_cache_11.PNG](./HTTP_header_cache_11.PNG)

### μΊμ‹ μ‹κ°„ μ΄κ³Ό
* μΊμ‹ μ ν¨ μ‹κ°„μ΄ μ΄κ³Όν•λ©΄, μ„λ²„λ¥Ό ν†µν•΄ λ°μ΄ν„°λ¥Ό λ‹¤μ‹ μ΅°νν•κ³ , μΊμ‹λ¥Ό κ°±μ‹ 
* μ΄λ• λ‹¤μ‹ λ„¤νΈμ›ν¬ λ‹¤μ΄λ΅λ“κ°€ λ°μƒν•λ‹¤.

> ## HTTP ν—¤λ”2 - μΊμ‹μ™€ μ΅°κ±΄λ¶€ μ”μ²­ - κ²€μ¦ ν—¤λ”μ™€ μ΅°κ±΄λ¶€ μ”μ²­ 1

### μΊμ‹ μ‹κ°„ μ΄κ³Ό
* μΊμ‹ μ ν¨ μ‹κ°„μ μ΄κ³Όλ΅ μ„λ²„μ— μ¬μ”μ²­ν•λ©΄ λ‹¤μ λ‘ κ°€μ§€ μƒν™©μ΄ λ‚νƒ€λ‚λ‹¤.
    1. μ„λ²„μ—μ„ κΈ°μ΅΄ λ°μ΄ν„°λ¥Ό λ³€κ²½ν•¨
    2. μ„λ²„μ—μ„ κΈ°μ΅΄ λ°μ΄ν„°λ¥Ό λ³€κ²½ν•μ§€ μ•μ

* μΊμ‹ λ§λ£ ν›„μ—λ„ μ„λ²„μ—μ„ λ°μ΄ν„°λ¥Ό λ³€κ²½ν•μ§€ μ•μ„ κ²½μ°
    * μƒκ°ν•΄λ³΄λ©΄ λ°μ΄ν„°λ¥Ό μ „μ†΅ν•λ” λ€μ‹ μ— μ €μ¥ν•΄ λ‘μ—λ μΊμ‹λ¥Ό μ¬μ‚¬μ© ν•  μ μλ‹¤.
    * ν•μ§€λ§ ν΄λΌμ΄μ–ΈνΈμ λ°μ΄ν„°μ™€ μ„λ²„μ λ°μ΄ν„°κ°€ κ°™λ‹¤λ” μ‚¬μ‹¤μ„ ν™•μΈν•  μ μλ” λ°©λ²•μ΄ ν•„μ”ν•λ‹¤.

![HTTP_header_cache_last-modified_1.PNG](./HTTP_header_cache_last-modified_1.PNG)
* *last modifiedλ” UTC ν‘κΈ°λ²•μΌλ΅ μ‘μ„±ν•΄μ•Ό ν•λ‹¤.*

![HTTP_header_cache_last-modified_2.PNG](./HTTP_header_cache_last-modified_2.PNG)
![HTTP_header_cache_last-modified_3.PNG](./HTTP_header_cache_last-modified_3.PNG)
![HTTP_header_cache_last-modified_4.PNG](./HTTP_header_cache_last-modified_4.PNG)
![HTTP_header_cache_last-modified_5.PNG](./HTTP_header_cache_last-modified_5.PNG)
![HTTP_header_cache_last-modified_6.PNG](./HTTP_header_cache_last-modified_6.PNG)
![HTTP_header_cache_last-modified_7.PNG](./HTTP_header_cache_last-modified_7.PNG)
![HTTP_header_cache_last-modified_8.PNG](./HTTP_header_cache_last-modified_8.PNG)

### κ²€μ¦ ν—¤λ”μ™€ μ΅°κ±΄λ¶€ μ”μ²­ - μ •λ¦¬
* μΊμ‹ μ ν¨ μ‹κ°„μ΄ μ΄κ³Όν•΄λ„, μ„λ²„μ λ°μ΄ν„°κ°€ κ°±μ‹ λμ§€ μ•μ•λ‹¤λ©΄ 304 Not Modified + ν—¤λ” λ©”νƒ€ μ •λ³΄λ§ μ‘λ‹µ(λ°”λ””X)
* ν΄λΌμ΄μ–ΈνΈλ” μ„λ²„κ°€ λ³΄λ‚Έ μ‘λ‹µ ν—¤λ” μ •λ³΄λ΅ μΊμ‹μ λ©”νƒ€ μ •λ³΄λ¥Ό κ°±μ‹ 
* ν΄λΌμ΄μ–ΈνΈλ” μΊμ‹μ— μ €μ¥λμ–΄ μλ” λ°μ΄ν„° μ¬ν™μ©
* κ²°κ³Όμ μΌλ΅ λ„¤νΈμ›ν¬ λ‹¤μ΄λ΅λ“κ°€ λ°μƒν•μ§€λ§, μ©λ‰μ΄ μ μ€ ν—¤λ” μ •λ³΄λ§ λ‹¤μ΄λ΅λ“
* λ§¤μ° μ‹¤μ©μ μΈ ν•΄κ²°μ±…

> ## HTTP ν—¤λ”2 - μΊμ‹μ™€ μ΅°κ±΄λ¶€ μ”μ²­ - κ²€μ¦ ν—¤λ”μ™€ μ΅°κ±΄λ¶€ μ”μ²­ 2

* **κ²€μ¦ ν—¤λ”**
    * μΊμ‹ λ°μ΄ν„°μ™€ μ„λ²„ λ°μ΄ν„°κ°€ κ°™μ€μ§€ κ²€μ¦ν•λ” λ°μ΄ν„°
    * Last-Modified, ETag
* **μ΅°κ±΄λ¶€ μ”μ²­ ν—¤λ”**
    * κ²€μ¦ ν—¤λ”λ΅ μ΅°κ±΄μ— λ”°λ¥Έ λ¶„κΈ°
    * if-Modified-Since: Last-Modified μ‚¬μ©
    * if-None-Match : ETag μ‚¬μ©
    * μ΅°κ±΄μ΄ λ§μ΅±ν•λ©΄ 200 OK
    * μ΅°κ±΄μ΄ λ§μ΅±ν•μ§€ μ•μΌλ©΄ 304 Not Modified

### μμ‹
* If-Modified-Since: μ΄ν›„μ— λ°μ΄ν„°κ°€ μμ •λμ—μΌλ©΄?
    * **λ°μ΄ν„° λ―Έλ³€κ²½ μμ‹**
        * μΊμ‹ : 2022λ…„ 1μ›” 15μΌ 11:25:00 vs μ„λ²„ : 2022λ…„ 1μ›” 15μΌ 11:25:00
        * **304 Not Modified**, ν—¤λ” λ°μ΄ν„°λ§ μ „μ†΅(BODY λ―Έν¬ν•¨)
        * μ „μ†΅ μ©λ‰ 0.1M (ν—¤λ” 0.1M, λ°”λ”” 1.0M)
    * **λ°μ΄ν„° λ³€κ²½ μμ‹**
        * μΊμ‹ : 2022λ…„ 1μ›” 15μΌ 11:25:00 vs μ„λ²„ : 2022λ…„ 1μ›” 15μΌ <span style="color:red">12:50:00</span>
        * **200 OK**, λ¨λ“  λ°μ΄ν„° μ „μ†΅(BODY ν¬ν•¨)
        * μ „μ†΅ μ©λ‰ 1.1M (ν—¤λ” 0.1M, λ°”λ”” 1.0M)

### Last-Modified, If-Modified-Since λ‹¨μ 
* 1μ΄ λ―Έλ§(0.Xμ΄) λ‹¨μ„λ΅ μΊμ‹ μ΅°μ •μ΄ λ¶κ°€λ¥
* λ‚ μ§ κΈ°λ°μ λ΅μ§ μ‚¬μ©
* λ°μ΄ν„°λ¥Ό μμ •ν•΄μ„ λ‚ μ§κ°€ λ‹¤λ¥΄μ§€λ§, κ°™μ€ λ°μ΄ν„°λ¥Ό μμ •ν•΄μ„ λ°μ΄ν„° κ²°κ³Όκ°€ λ‘κ°™μ€ κ²½μ°
    * μ) A -> Bλ΅ μμ •ν–λ‹¤κ°€ λ‹¤μ‹ B -> Aλ΅ μμ •ν• κ²½μ°
* μ„λ²„μ—μ„ λ³„λ„μ μΊμ‹ λ΅μ§μ„ κ΄€λ¦¬ν•κ³  μ‹¶μ€ κ²½μ°
    * μ) μ¤νμ΄μ¤λ‚ μ£Όμ„μ²λΌ ν¬κ² μν–¥μ΄ μ—†λ” λ³€κ²½μ—μ„ μΊμ‹λ¥Ό μ μ§€ν•κ³  μ‹¶μ€ κ²½μ°

### ETag, If-None-Match
* ETag(Entity Tag)
* μΊμ‹μ© λ°μ΄ν„°μ— μ„μμ κ³ μ ν• λ²„μ „ μ΄λ¦„μ„ λ‹¬μ•„λ‘ 
    * μ) ETag: "v1.0", ETag: "a2jiodwjekjl3"
* λ°μ΄ν„°κ°€ λ³€κ²½λλ©΄ μ΄ μ΄λ¦„μ„ λ°”κΎΈμ–΄μ„ λ³€κ²½ν•¨(Hashλ¥Ό λ‹¤μ‹ μƒμ„±)
    * μ) ETag: "aaaaa" -> ETag: "bbbbb"
* μ§„μ§ λ‹¨μν•κ² ETagλ§ λ³΄λ‚΄μ„ κ°™μΌλ©΄ μ μ§€, λ‹¤λ¥΄λ©΄ λ‹¤μ‹ λ°›κΈ°

![HTTP_header_cache_etag_1.PNG](./HTTP_header_cache_etag_1.PNG)
![HTTP_header_cache_etag_2.PNG](./HTTP_header_cache_etag_2.PNG)
![HTTP_header_cache_etag_3.PNG](./HTTP_header_cache_etag_3.PNG)
![HTTP_header_cache_etag_4.PNG](./HTTP_header_cache_etag_4.PNG)
![HTTP_header_cache_etag_5.PNG](./HTTP_header_cache_etag_5.PNG)
![HTTP_header_cache_etag_6.PNG](./HTTP_header_cache_etag_6.PNG)
![HTTP_header_cache_etag_7.PNG](./HTTP_header_cache_etag_7.PNG)
![HTTP_header_cache_etag_8.PNG](./HTTP_header_cache_etag_8.PNG)

### ETag, If-None-Match μ •λ¦¬
* ETagλ§ μ„λ²„μ— λ³΄λ‚΄μ„ λ°μ΄ν„° λΉ„κµ
* **μΊμ‹ μ μ–΄ λ΅μ§μ„ μ„λ²„μ—μ„ μ™„μ „ν κ΄€λ¦¬**
* ν΄λΌμ΄μ–ΈνΈλ” λ‹¨μν μ΄ κ°’μ„ μ„λ²„μ— μ κ³µ(ν΄λΌμ΄μ–ΈνΈλ” μΊμ‹ λ©”μ»¤λ‹μ¦μ„ λ¨λ¥Έλ‹¤.)
* μ)
    * μ„λ²„λ” λ² νƒ€ μ¤ν” κΈ°κ°„μΈ 3μΌ λ™μ• νμΌμ΄ λ³€κ²½λμ–΄λ„ ETagλ¥Ό λ™μΌν•κ² μ μ§€
    * μ• ν”λ¦¬μΌ€μ΄μ… λ°°ν¬ μ£ΌκΈ°μ— λ§μ¶”μ–΄ ETag λ¨λ‘ κ°±μ‹ 

> ## HTTP ν—¤λ”2 - μΊμ‹μ™€ μ΅°κ±΄λ¶€ μ”μ²­ - μΊμ‹ μ μ–΄ ν—¤λ”

### Cache-Control - μΊμ‹ μ§€μ‹μ–΄(directives)
* Cache-Control: max-age
    * μΊμ‹ μ ν¨ μ‹κ°„, μ΄ λ‹¨μ„
* Cache-Control: no-cache
    * λ°μ΄ν„°λ” μΊμ‹ν•΄λ„ λμ§€λ§, ν•­μƒ μ¤λ¦¬μ§„ μ„λ²„μ— κ²€μ¦ν•κ³  μ‚¬μ©
* Cache-Control: no-store
    * λ°μ΄ν„°μ— λ―Όκ°ν• μ •λ³΄κ°€ μμΌλ―€λ΅ μ €μ¥ν•λ©΄ μ• λ¨(λ©”λ¨λ¦¬μ—μ„ μ‚¬μ©ν•κ³  μµλ€ν• λΉ¨λ¦¬ μ‚­μ )

### Pragma - μΊμ‹ μ μ–΄(ν•μ„ νΈν™)
* Pragma: no-cahce
* HTTP 1.0 ν•μ„ νΈν™
* μ§€κΈμ€ κ±°μ μ‚¬μ©ν•μ§€ μ•μ

### Expires - μΊμ‹ λ§λ£μΌ μ§€μ •(ν•μ„ νΈν™)
* expires: Mon, 01 Jan 1990 00:00:00 GMT
* μΊμ‹ λ§λ£μΌμ„ μ •ν™•ν• λ‚ μ§λ΅ μ§€μ •
* HTTP 1.0λ¶€ν„° μ‚¬μ©
* μ§€κΈμ€ λ” μ μ—°ν• Cache-Control: max-age κ¶μ¥
* Cache-Control: max-ageμ™€ ν•¨κ» μ‚¬μ©ν•λ©΄ Expiresλ” λ¬΄μ‹

### κ²€μ¦ ν—¤λ”μ™€ μ΅°κ±΄λ¶€ μ”μ²­ ν—¤λ”
* **κ²€μ¦ ν—¤λ”(Validator)**
    * **ETag**: "v1.0", ETag: "asid93jkrh2l"
    * **Last-Modified**: Sat, 15 Jan 2022 09:11:25 GMT
* **μ΅°κ±΄λ¶€ μ”μ²­ ν—¤λ”**
    * If-Match, If-None-Match: ETag κ°’ μ‚¬μ©
    * If-Modified-Since, If-Unmodified-Since: Last-Modified κ°’ μ‚¬μ©

> ## HTTP ν—¤λ”2 - μΊμ‹μ™€ μ΅°κ±΄λ¶€ μ”μ²­ - ν”„λ΅μ‹ μΊμ‹

![HTTP_header_proxy_1.PNG](./HTTP_header_proxy_1.PNG)
![HTTP_header_proxy_2.PNG](./HTTP_header_proxy_2.PNG)

### Cache-Control - μΊμ‹ μ§€μ‹μ–΄(directives)  - κΈ°νƒ€
* Cache-Control: public
    * μ‘λ‹µμ΄ public μΊμ‹μ— μ €μ¥λμ–΄λ„ λ¨
* Cache-Control: private
    * μ‘λ‹µμ΄ ν•΄λ‹Ή μ‚¬μ©μλ§μ„ μ„ν• κ²ƒμ„, private μΊμ‹μ— μ €μ¥ν•΄μ•Ό ν•¨(κΈ°λ³Έκ°’)
* Cache-Control: s-maxage
    * ν”„λ΅μ‹ μΊμ‹μ—λ§ μ μ©λλ” max-age
* Age: 60(HTTP ν—¤λ”)
    * μ¤λ¦¬μ§„ μ„λ²„μ—μ„ μ‘λ‹µ ν›„ ν”„λ΅μ‹ μΊμ‹ λ‚΄μ— λ¨Έλ¬Έ μ‹κ°„(μ΄)
    
> ## HTTP ν—¤λ”2 - μΊμ‹μ™€ μ΅°κ±΄λ¶€ μ”μ²­ - μΊμ‹ λ¬΄ν¨ν™”

### Cache-Control - μΊμ‹ μ§€μ‹μ–΄(directives) - ν™•μ‹¤ν• μΊμ‹ λ¬΄ν¨ν™”
* Cache-Control: no-cache
    * λ°μ΄ν„°λ” μΊμ‹ ν•΄λ„ λμ§€λ§, ν•­μƒ **μ› μ„λ²„μ— κ²€μ¦**ν•κ³  μ‚¬μ©(μ΄λ¦„μ— μ£Όμ!)
* Cache-Control: no-store
    * λ°μ΄ν„°μ— λ―Όκ°ν• μ •λ³΄κ°€ μμΌλ―€λ΅ μ €μ¥ν•λ©΄ μ• λ¨(λ©”λ¨λ¦¬μ—μ„ μ‚¬μ©ν•κ³  μµλ€ν• λΉ¨λ¦¬ μ‚­μ )
* Cache-Control: must-revalidate
    * μΊμ‹ λ§λ£ ν›„ μµμ΄ μ΅°ν μ‹ **μ› μ„λ²„μ— κ²€μ¦**ν•΄μ•Ό ν•¨
    * μ› μ„λ²„ μ ‘κ·Ό μ‹¤ν¨ μ‹ λ°λ“μ‹ μ¤λ¥κ°€ λ°μƒν•΄μ•Ό ν•¨ - 504 Gateway Timeout
    * must-revalidateλ” μΊμ‹ μ ν¨ μ‹κ°„μ΄λΌλ©΄ μΊμ‹λ¥Ό μ‚¬μ©ν•¨
* Pragma: no-cache
    * HTTP 1.0 ν•μ„ νΈν™

![HTTP_header_no-cache_1.PNG](./HTTP_header_no-cache_1.PNG)
![HTTP_header_no-cache_2.PNG](./HTTP_header_no-cache_2.PNG)
![HTTP_header_must-revalidate.PNG](./HTTP_header_must-revalidate.PNG)

***
## π’΅ ν‹€λ Έκ±°λ‚ μλ»λ μ •λ³΄κ°€ μλ‹¤λ©΄ λ§μ„¤μ„ μ—†μ΄ λ“κΈ€λ΅ μ•λ ¤μ£Όμ„Έμ”!

